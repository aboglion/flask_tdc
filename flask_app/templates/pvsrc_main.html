<!DOCTYPE html>
<html>

<head>




    <title>PV SOURCE Viewer</title>

    <style>



        body {
            max-width: 100vw;
            font-family: Times New Roman;
            font-weight: 300;
            /* line-height: 1.42em; */
            color: #A7A1AE;
            background-color: #1F2739;
            text-align: center;
            /* font-size: medium; */
        }

        p{
            font-size: large;
        }
        input[type="submit"] {
            background-color: #4caf50;
            color: #ffffff;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s ease;
            display: inline;
            border-radius: 10%;
            height: 30px;
            font-size: 20px;


        }

        input[type="submit"]:hover {
            background-color: #45a548;
            border: 2px solid #ff0000;
            transition-duration: 2s;

        }

        .new-row {
            color: #e53935;
        }

        form {
            display: flex;
            align-items: center;
            justify-content: center;
        }


          

        .M_L-button {
            position: fixed;
            z-index: 4;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            -webkit-transition-duration: 2s;
            transition-duration: 2s;
            width: 10vh;
            height: 10vh;
            background-color: rgba(51, 51, 95, 0.5);
            border-radius: 50%;
            line-height: 10vh;
            border: 3px solid rgba(239, 202, 157, 0.5);
            box-shadow: 0 0 10px rgba(255, 255, 0, 0);
            color: white;
            text-decoration: none;
            padding: 0;
            font-size: 5vh;
            top: -3.7vh;
        }

        .M_L-button:hover {
            transition-duration: 0.5s !important;
            font-size: 5vh;
            top: 1vh;
            box-shadow: 0 0 10px rgba(255, 255, 0, 1);
            border-color: orange;
        }
        .button,a {
            color: #2effa8;
        }

        a:hover {
            color: #ff8000 !important;
        }

        .custom-textarea {
            color: #60f000;
            direction: rtl;
            text-align: right;
            font-size: 20px;
            background-color: rgba(52, 60, 102, 0.534);
            width: 200px;
            /* Adjust the width as needed */
            height: 60px;
            /* Adjust the height as needed */
            border: 1px solid #ccc;
            padding: 5px;
            width: 100%;
        }

        .custom-textarea:hover {
            background-color: black;
            color: #d9e3f0;

        }
 

        th:hover {
            background-color: #a4ac95;
        }


        h1 {
            font-size: 3em;
            font-weight: 300;
            line-height: 1em;
            text-align: center;
            color: #4DC3FA;
        }

        h2 {
            font-size: 1em;
            font-weight: 300;
            text-align: center;
            display: block;
            line-height: 1em;
            padding-bottom: 2em;
            color: #FB667A;
        }

        h2 a {
            font-weight: 700;
            text-transform: uppercase;
            color: #FB667A;
            text-decoration: none;
        }

        table {
            width: 100vw;
            border-collapse: collapse;
        }

        td {
            /* font-weight: normal; */
            /* font-size: 1em; */
            -webkit-box-shadow: 0 2px 2px -2px #0E1119;
            -moz-box-shadow: 0 2px 2px -2px #0E1119;
            box-shadow: 0 2px 2px -2px #0E1119;
        }


  

        /* Background-color of the odd rows */
        tr:nth-child(odd) {
            background-color: #323C50;
        }

        /* Background-color of the even rows */
        tr:nth-child(even) {
            background-color: #2C3446;
        }



        td:first-child {
            color: #FB667A;
        }
        tr{
            height: min-content;
            border-bottom: 1px solid #ddd;
        }
        tr:hover {
            background-color:#3c8bb576;
            color:yellow !important;
  
            border: #4DC3FA;

        }



     
      
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.2/xlsx.full.min.js"></script>
</head>

<body>
    <img>

    <h1>◊™◊í◊ô◊ù ◊û◊ê◊ï◊ú◊¶◊ô◊ù</h1>
    <button onclick="sortit()">sortit</button>

    <button onclick="exportTableToExcel('tableId', 'PVSOURCE.xls')">Export to Excel</button>
    <h4 style="color: #2196f3;text-align: center">◊û◊¢◊ï◊ì◊õ◊ü ◊ú◊ô◊ï◊ù {{date}} ◊ú◊ó◊ï◊ì◊©</h4>
    <a style="left: 5vw" href="{{url_for('main_page')}}" class="M_L-button">
        <i>üè†</i>
    </a>
    {% if session['logged_in'] %}
    <a style="left: 10vw; color: red; font-size: medium;" href="{{url_for('log_out')}}" class="M_L-button">
        <i>OUT</i>
    </a>
    {% else %}
    <a style="left: 10vw" href="{{url_for('log_in')}}" class="M_L-button">
        <i>üîë</i>
    </a>
    {% endif %}

    <table id="tableId">

            {% for row in data %}
            {% set mitkan0_name1 = row.ENTITY.split(" => ") %}
            <tr{% if row.NEW %} style="color: #ff3800;" {% else %} style="color: #c9e8eb;" {% endif %}>

                <td><a class="button" href="{{ url_for('history', entity=row.ENTITY) }}">History</a></td>
                <td style="font-size: 25px;"><a
                        href="/tags_table/{{ mitkan0_name1[1]}}/~/~/~/~/~/~/{% if mitkan0_name1[0] == " 660" %}~{% else
                        %}{{mitkan0_name1[0]}}{% endif %}/~/~/~/~/~/~/~/~/0/0">
                        <i class="button">{{mitkan0_name1[0]}}</i>
                        <p class="button">{{mitkan0_name1[1]}}</p>
                    </a></td>
                <td>{{ row.PVSOURCE }}</td>
                <td>{{ row.PTDESC }}</td>
                <td>
                    {% if session['logged_in'] %}
                    <form action="/save" method="POST">
                        <input type="hidden" name="witch" value="{{ row.ENTITY }}">
                        <textarea id="{{ row.ENTITY }}" class="custom-textarea" rows="2"
                            name="value">{{ row.REASON }}</textarea>
                        <input type="submit" value="Save">
                    </form>
                    {% else %}
                    {{ row.REASON }}
                    {% endif %}

                </td>
                <td>{{ row.START_AT }}</td>
                <td style="display: none;">{{ row.NEW }}</td>
                </tr>
                {% endfor %}
    </table>
</body>


<script>
    function exportTableToExcel(tableId, filename = '') {
    var downloadLink;
    var dataType = 'application/vnd.ms-excel';
    var tableSelect = document.getElementById(tableId);
    var tableHTML = encodeURIComponent(tableSelect.outerHTML); // Encode the HTML

    // Specify file name
    filename = filename ? filename : 'excel_data.xls';

    // Create download link element
    downloadLink = document.createElement("a");

    document.body.appendChild(downloadLink);

    if (navigator.msSaveOrOpenBlob) {
        var blob = new Blob(['\ufeff', tableHTML], {
            type: dataType
        });
        navigator.msSaveOrOpenBlob(blob, filename);
    } else {
        // Create a link to the file
        downloadLink.href = 'data:' + dataType + ', ' + tableHTML;

        // Setting the file name
        downloadLink.download = filename;

        // Triggering the function
        downloadLink.click();
    }
}



</script>


</html>